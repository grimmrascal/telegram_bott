import asyncio
import logging
import random
import os
import requests
import psycopg2
from psycopg2.extras import RealDictCursor
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from aiogram import Router
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from apscheduler.triggers.cron import CronTrigger
from pytz import timezone
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
load_dotenv()
TOKEN = os.getenv("BOT_TOKEN")
PIXABAY_API_KEY = os.getenv("PIXABAY_API_KEY")
DATABASE_URL = os.getenv("DATABASE_URL")

if not TOKEN:
    raise ValueError("‚ùå –¢–æ–∫–µ–Ω –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª .env.")
if not PIXABAY_API_KEY:
    raise ValueError("‚ùå API-–∫–ª—é—á Pixabay –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª .env.")
if not DATABASE_URL:
    raise ValueError("‚ùå URL –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª .env.")

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s")

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–æ—Ç–∞ —ñ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token=TOKEN)
dp = Dispatcher()

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Router
router = Router()
dp.include_router(router)

# –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å –ö–∏—î–≤–∞
kyiv_tz = timezone("Europe/Kyiv")

# –°–ø–∏—Å–æ–∫ Telegram user_id –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤—ñ–¥ –±–æ—Ç–∞
ADMIN_USER_IDS = [471637263, 5142786008, 646146668]  # –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–ø–∏—Å–æ–∫ —Ä–µ–∞–ª—å–Ω–∏—Ö user_id

# –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö PostgreSQL
conn = psycopg2.connect(DATABASE_URL, sslmode="require")
cursor = conn.cursor(cursor_factory=RealDictCursor)

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
cursor.execute('''
    CREATE TABLE IF NOT EXISTS users (
        id SERIAL PRIMARY KEY,
        user_id BIGINT UNIQUE NOT NULL,
        username TEXT,
        first_name TEXT
    )
''')
conn.commit()

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ –∑ –∫–Ω–æ–ø–∫–∞–º–∏
def create_reaction_keyboard():
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="‚ù§Ô∏è", callback_data="reaction:like"),
            InlineKeyboardButton(text="üîÑ", callback_data="reaction:new_photo"),
        ]
    ])
    return keyboard

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def add_user(user_id, username, first_name):
    try:
        cursor.execute('''
            INSERT INTO users (user_id, username, first_name)
            VALUES (%s, %s, %s)
            ON CONFLICT (user_id) DO NOTHING
        ''', (user_id, username, first_name))
        conn.commit()
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} –¥–æ–¥–∞–Ω–∏–π –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.")
    except Exception as e:
        conn.rollback()  # –°–∫–∞—Å–æ–≤—É—î–º–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏
        logging.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {user_id}: {e}")

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def remove_user(user_id):
    try:
        cursor.execute('DELETE FROM users WHERE user_id = %s', (user_id,))
        conn.commit()
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} –≤–∏–¥–∞–ª–µ–Ω–∏–π —ñ–∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.")
    except Exception as e:
        conn.rollback()  # –°–∫–∞—Å–æ–≤—É—î–º–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏
        logging.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {user_id}: {e}")

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def get_all_users():
    try:
        cursor.execute('SELECT user_id, username, first_name FROM users')
        return cursor.fetchall()
    except Exception as e:
        conn.rollback()  # –°–∫–∞—Å–æ–≤—É—î–º–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —É —Ä–∞–∑—ñ –ø–æ–º–∏–ª–∫–∏
        logging.error(f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ —Å–ø–∏—Å–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: {e}")
        return []

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞ —Ç–µ–º–æ—é
def get_random_image(query="funny, kids, sunset, motivation"):
    url = f"https://pixabay.com/api/?key={PIXABAY_API_KEY}&q={query}&image_type=photo&per_page=50"
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        if data["hits"]:
            return random.choice(data["hits"])["webformatURL"]
    return None

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /start
@router.message(Command("start"))
async def start_handler(message: types.Message):
    user_id = message.from_user.id
    username = message.from_user.username
    first_name = message.from_user.first_name

    # –ó–∞–ø–∏—Ç—É—î–º–æ –ø–∞—Ä–æ–ª—å
    await message.answer("üîí –í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –±–æ—Ç–∞:")

    # –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è
    @router.message()
    async def password_handler(password_message: types.Message):
        entered_password = password_message.text
        correct_password = os.getenv("BOT_PASSWORD")  # –û—Ç—Ä–∏–º—É—î–º–æ –ø–∞—Ä–æ–ª—å —ñ–∑ .env

        if entered_password == correct_password:
            # –î–æ–¥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
            add_user(user_id, username, first_name)
            await password_message.answer(f"‚úÖ –ü–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π! –ü—Ä–∏–≤—ñ—Ç, {first_name}! –¢–∏ –¥–æ–¥–∞–Ω–∞ —É —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—Å–∏–ª–∫–∏.")
            logging.info(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} ({username}) –¥–æ–¥–∞–Ω–∏–π —É —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—Å–∏–ª–∫–∏.")
        else:
            await password_message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å. –î–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.")
            logging.warning(f"‚ùå –ù–µ–≤–¥–∞–ª–∞ —Å–ø—Ä–æ–±–∞ –¥–æ—Å—Ç—É–ø—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {user_id} ({username}).")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /sendnow –¥–ª—è –º–∏—Ç—Ç—î–≤–æ—ó —Ä–æ–∑—Å–∏–ª–∫–∏
@dp.message(Command("sendnow"))
async def send_now_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        await send_random_messages()
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /t –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ —Ç–µ–∫—Å—Ç—É –∞–±–æ —Ñ–æ—Ç–æ –≤—Å—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, –∫—Ä—ñ–º –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
@dp.message(Command("t"))
async def broadcast_handler(message: types.Message):
    if message.from_user.id not in ADMIN_USER_IDS:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")
        return

    try:
        users = get_all_users()

        if not users:
            await message.answer("‚ùå –ù–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏.")
            return

        # **–û–±—Ä–æ–±–∫–∞ —Ñ–æ—Ç–æ**
        if message.photo:
            photo_id = message.photo[-1].file_id  # –û—Ç—Ä–∏–º—É—î–º–æ —Ñ–æ—Ç–æ —É –Ω–∞–π–∫—Ä–∞—â—ñ–π —è–∫–æ—Å—Ç—ñ
            
            # –í–∏–¥–∞–ª—è—î–º–æ —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥–∏ `/t` –∑ –ø—ñ–¥–ø–∏—Å—É, —è–∫—â–æ –≤—ñ–Ω —î
            caption = message.caption if message.caption else ""
            caption = caption.replace("/t", "").strip()  # –í–∏–¥–∞–ª—è—î–º–æ –∫–æ–º–∞–Ω–¥—É —Ç–∞ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏

            for user in users:
                if user['user_id'] == message.from_user.id:
                    continue  # –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞

                try:
                    await bot.send_photo(chat_id=user['user_id'], photo=photo_id, caption=caption or None)
                    logging.info(f"üì® –§–æ—Ç–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user['user_id']}")
                except Exception as e:
                    logging.warning(f"‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ñ–æ—Ç–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user['user_id']}: {e}")

            await message.answer("‚úÖ –§–æ—Ç–æ —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—ñ—Å–ª–∞–Ω–æ –≤—Å—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º!")
            return  # –í–ê–ñ–õ–ò–í–û! –í–ò–•–û–î–ò–ú–û –ó –§–£–ù–ö–¶–Ü–á, –©–û–ë –ù–ï –û–ë–†–û–ë–õ–Ø–¢–ò –¢–ï–ö–°–¢

        # **–û–±—Ä–æ–±–∫–∞ —Ç–µ–∫—Å—Ç—É (—è–∫—â–æ —Ñ–æ—Ç–æ –Ω–µ–º–∞—î)**
        text_content = message.text[len("/t"):].strip()  # –í–∏–¥–∞–ª—è—î–º–æ "/t" —ñ –∑–∞–π–≤—ñ –ø—Ä–æ–±—ñ–ª–∏

        if not text_content:
            await message.answer("‚ùå –í–∏ –Ω–µ –Ω–∞–ø–∏—Å–∞–ª–∏ —Ç–µ–∫—Å—Ç –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏!")
            return

        for user in users:
            if user['user_id'] == message.from_user.id:
                continue  # –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞

            try:
                await bot.send_message(user['user_id'], text_content)
                logging.info(f"üì® –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user['user_id']}")
            except Exception as e:
                logging.warning(f"‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user['user_id']}: {e}")

        await message.answer("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—ñ—Å–ª–∞–Ω–æ –≤—Å—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º!")

    except Exception as e:
        await message.answer(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ä–æ–∑—Å–∏–ª—Ü—ñ: {e}")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /get_users –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É —É—á–∞—Å–Ω–∏–∫—ñ–≤
@dp.message(Command("get_users"))
async def get_users_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        users = get_all_users()
        if users:
            user_list = "\n".join([f"ID: {user['user_id']}, –Ü–º'—è: {user['first_name']}, –ù—ñ–∫–Ω–µ–π–º: @{user['username'] if user['username'] else '–Ω–µ–º–∞—î'}" for user in users])
            await message.answer(f"üìã –°–ø–∏—Å–æ–∫ —É—á–∞—Å–Ω–∏–∫—ñ–≤:\n{user_list}")
        else:
            await message.answer("‚ùå –°–ø–∏—Å–æ–∫ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π.")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /add_user –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
@dp.message(Command("add_user"))
async def add_user_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        try:
            # –†–æ–∑–¥—ñ–ª—è—î–º–æ —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥–∏ –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏
            command_parts = message.text.split(maxsplit=1)
            if len(command_parts) < 2:
                await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: /add_user <user_id>")
                return

            # –û—Ç—Ä–∏–º—É—î–º–æ user_id
            user_id = int(command_parts[1])

            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∂–µ —ñ—Å–Ω—É—î
            cursor.execute('SELECT * FROM users WHERE user_id = %s', (user_id,))
            existing_user = cursor.fetchone()
            if existing_user:
                await message.answer(f"‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ–∑ ID {user_id} –≤–∂–µ —ñ—Å–Ω—É—î –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö.")
                return

            # –û—Ç—Ä–∏–º—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ Telegram API
            try:
                user = await bot.get_chat(user_id)
                username = user.username if user.username else "–Ω–µ–º–∞—î"
                first_name = user.first_name if user.first_name else "–Ω–µ–º–∞—î"
            except Exception as e:
                await message.answer(f"‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ ID {user_id}: {e}")
                return

            # –î–æ–¥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
            add_user(user_id, username, first_name)
            await message.answer(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–¥–∞–Ω–∏–π:\nID: {user_id}\n–Ü–º'—è: {first_name}\n–ù—ñ–∫–Ω–µ–π–º: @{username}")
        except ValueError:
            await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. user_id –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º.")
        except Exception as e:
            await message.answer(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: {e}")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /remove_user –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
@dp.message(Command("remove_user"))
async def remove_user_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        try:
            # –†–æ–∑–¥—ñ–ª—è—î–º–æ —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥–∏ –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏
            command_parts = message.text.split(maxsplit=1)
            if len(command_parts) < 2:
                await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: /remove_user <user_id>")
                return

            # –û—Ç—Ä–∏–º—É—î–º–æ user_id
            user_id = int(command_parts[1])

            # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ—Å–Ω—É—î
            cursor.execute('SELECT * FROM users WHERE user_id = %s', (user_id,))
            existing_user = cursor.fetchone()
            if not existing_user:
                await message.answer(f"‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ ID {user_id} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö.")
                return

            # –í–∏–¥–∞–ª—è—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
            remove_user(user_id)
            await message.answer(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ–∑ ID {user_id} —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–∏–π.")
        except ValueError:
            await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. user_id –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º.")
        except Exception as e:
            await message.answer(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: {e}")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

@router.callback_query(lambda callback: callback.data.startswith("reaction:"))
async def reaction_handler(callback: types.CallbackQuery):
    if callback.data == "reaction:like":
        await callback.answer("‚ù§Ô∏è –î—è–∫—É—é –∑–∞ —Ç–≤–æ—é —Ä–µ–∞–∫—Ü—ñ—é!")
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {callback.from_user.id} –Ω–∞—Ç–∏—Å–Ω—É–≤ ‚ù§Ô∏è")
    elif callback.data == "reaction:new_photo":
        await callback.answer("üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é –Ω–æ–≤–µ —Ñ–æ—Ç–æ...")
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {callback.from_user.id} –∑–∞–ø—Ä–æ—Å–∏–≤ –Ω–æ–≤–µ —Ñ–æ—Ç–æ")

        # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –Ω–æ–≤–µ —Ñ–æ—Ç–æ
        image = get_random_image(query="motivation")
        if image:
            await bot.send_photo(
                callback.from_user.id,
                photo=image,
                caption="–û—Å—å –Ω–æ–≤–µ —Ñ–æ—Ç–æ –¥–ª—è –≤–∞—Å!",
                reply_markup=create_reaction_keyboard()
            )
        else:
            await callback.message.answer("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–µ —Ñ–æ—Ç–æ.")

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –ø—Ä–∏—î–º–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
async def send_random_messages():
    messages = [
        "–¢–∏ —á—É–¥–æ–≤–∏–π!", "–ù–µ –∑–∞–±—É–≤–∞–π –ø–æ—Å–º—ñ—Ö–∞—Ç–∏—Å—è!", "–í —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ!", "–¢–∏ –æ—Å–æ–±–ª–∏–≤–∏–π!", "–¢–∏ —á—É–¥–æ–≤–∏–π!", "–ù–µ –∑–∞–±—É–≤–∞–π –ø–æ—Å–º—ñ—Ö–∞—Ç–∏—Å—è!", "–í —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ!", "–¢–∏ –æ—Å–æ–±–ª–∏–≤–∏–π!",
        "–ù–æ–≤–∏–π –¥–µ–Ω—å ‚Äì –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ! –õ–æ–≤–∏ —ó—Ö!", "–¢–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π, –Ω—ñ–∂ –¥—É–º–∞—î—à. –£—Å–µ –≤–∏–π–¥–µ!",
        "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–≤—ñ–π –¥–µ–Ω—å ‚Äì –∑—Ä–æ–±–∏ –π–æ–≥–æ –∫—Ä—É—Ç–∏–º!", "–ü—Ä–æ–∫–∏–¥–∞–π—Å—è! –£ —Å–≤—ñ—Ç—É –¥–ª—è —Ç–µ–±–µ —î —â–æ—Å—å –æ—Å–æ–±–ª–∏–≤–µ!",
        "–°–æ–Ω—Ü–µ –≤–∂–µ —Å–≤—ñ—Ç–∏—Ç—å –¥–ª—è —Ç–µ–±–µ ‚Äì —á–∞—Å –ø—ñ–¥–∫–æ—Ä—é–≤–∞—Ç–∏ —Å–≤—ñ—Ç!", "–ó—Ä–æ–±–∏ —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–µ, –ø—Ä–æ —â–æ –∑–∞–≤—Ç—Ä–∞ –ø–æ–¥—è–∫—É—î—à —Å–æ–±—ñ!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è ‚Äì —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞! –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π —ó—ó!", "–ö–æ–∂–µ–Ω –Ω–æ–≤–∏–π —Ä–∞–Ω–æ–∫ ‚Äì —Ü–µ —à–∞–Ω—Å –ø–æ—á–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É!",
        "–ù–µ –±—ñ–π—Å—è —Ç—Ä—É–¥–Ω–æ—â—ñ–≤ ‚Äì –≤–æ–Ω–∏ —Ä–æ–±–ª—è—Ç—å —Ç–µ–±–µ —Å–∏–ª—å–Ω—ñ—à–∏–º!", "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ –Ω–∞ –∫—Ä–æ–∫ –±–ª–∏–∂—á–µ –¥–æ —Å–≤–æ—î—ó –º—Ä—ñ—ó!",
        "–î–∏—Ö–∞–π –≥–ª–∏–±—à–µ, —É—Å–º—ñ—Ö–∞–π—Å—è —à–∏—Ä—à–µ ‚Äì –≤–ø–µ—Ä–µ–¥ –¥–æ —É—Å–ø—ñ—Ö—É!", "–°–≤—ñ—Ç —á–µ–∫–∞—î –Ω–∞ —Ç–≤–æ—ó –∑–≤–µ—Ä—à–µ–Ω–Ω—è!",
        "–ë—É–¥—å —Å–æ–±–æ—é ‚Äì —Ü–µ –≤–∂–µ —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞!", "–ö–∞–≤–∞, –∑–∞—Ä—è–¥ –ø–æ–∑–∏—Ç–∏–≤—É —ñ –≤–ø–µ—Ä–µ–¥ –¥–æ –ø–µ—Ä–µ–º–æ–≥!",
        "–©–∞—Å–ª–∏–≤–∏–π –¥–µ–Ω—å –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ —É—Å–º—ñ—à–∫–∏!", "–ù–µ –≤—ñ–¥–∫–ª–∞–¥–∞–π —â–∞—Å—Ç—è ‚Äì —Å—Ç–≤–æ—Ä—é–π –π–æ–≥–æ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!",
        "–†–æ–±–∏ —Ç–µ, —â–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ç–æ–±—ñ —Ä–∞–¥—ñ—Å—Ç—å!", "–¢–≤–æ—ó —Å—Ç–∞—Ä–∞–Ω–Ω—è –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –ø—Ä–∏–Ω–µ—Å—É—Ç—å –ø–ª–æ–¥–∏!",
        "–ú–∞–ª–µ–Ω—å–∫—ñ –∫—Ä–æ–∫–∏ –≤–µ–¥—É—Ç—å –¥–æ –≤–µ–ª–∏–∫–∏—Ö –ø–µ—Ä–µ–º–æ–≥!", "–ó–∞—Ä–∞–∑ ‚Äì –Ω–∞–π–∫—Ä–∞—â–∏–π —á–∞—Å, —â–æ–± –ø–æ—á–∞—Ç–∏ –¥—ñ—è—Ç–∏!",
        "–ù–∞–≤—ñ—Ç—å –Ω–∞–π—Ç–µ–º–Ω—ñ—à–∏–π —Ä–∞–Ω–æ–∫ –º–æ–∂–µ —Å—Ç–∞—Ç–∏ —è—Å–∫—Ä–∞–≤–∏–º!", "–í—ñ–¥–ø—É—Å—Ç–∏ —Å—É–º–Ω—ñ–≤–∏ ‚Äì –≤–ø–µ—Ä–µ–¥ –¥–æ –∑–≤–µ—Ä—à–µ–Ω—å!",
        "–ñ–∏–≤–∏ —Ü–µ–π –¥–µ–Ω—å —Ç–∞–∫, —â–æ–± —É–≤–µ—á–µ—Ä—ñ —Å–∫–∞–∑–∞—Ç–∏: ‚Äú–Ø –º–æ–ª–æ–¥–µ—Ü—å!‚Äù", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ —â–∞—Å–ª–∏–≤–µ —ñ –Ω–∞—Å–∏—á–µ–Ω–µ –∂–∏—Ç—Ç—è!",
        "–î–∏–≤–∏—Å—å –Ω–∞ —Å–≤—ñ—Ç –∑ –æ–ø—Ç–∏–º—ñ–∑–º–æ–º ‚Äì –≤—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å —Ç–æ–±—ñ —Ç–∏–º —Å–∞–º–∏–º!", "–ö–æ–∂–Ω–∞ —Ç–≤–æ—è –¥—ñ—è ‚Äì —Ü–µ –∫—Ä–æ–∫ –¥–æ —É—Å–ø—ñ—Ö—É!",
        "–†–æ–∑–ø—Ä–∞–≤ –∫—Ä–∏–ª–∞ —ñ –ª–µ—Ç–∏ –¥–æ —Å–≤–æ—î—ó –º—Ä—ñ—ó!", "–¢–∏ –º–æ–∂–µ—à –¥–æ—Å—è–≥—Ç–∏ –≤—Å—å–æ–≥–æ, —â–æ –∑–∞–¥—É–º–∞–Ω–æ!", "–ù–æ–≤–∏–π –¥–µ–Ω—å ‚Äì –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ. –í–ø–µ—Ä–µ–¥!",      "–¢–∏ –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–∏–π!", "–í—ñ—Ä —É —Å–µ–±–µ ‚Äì —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –±—ñ–ª—å—à–µ!", "–¢–∏ –∑–¥–æ–ª–∞—î—à –±—É–¥—å-—è–∫—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!",
        "–ù—ñ–∫–æ–ª–∏ –Ω–µ –∑–¥–∞–≤–∞–π—Å—è!", "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ –Ω–æ–≤–∏–π —à–∞–Ω—Å!", "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ –º–µ—Ç–∏!",
        "–ü—Ä–æ–¥–æ–≤–∂—É–π —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ø–µ—Ä–µ–¥, —Ç–∏ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —à–ª—è—Ö—É!", "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å ‚Äì —Ç–≤—ñ–π –∫–ª—é—á –¥–æ —É—Å–ø—ñ—Ö—É!",
        "–ñ–∏—Ç—Ç—è –¥–∞—Ä—É—î —Ç–æ–±—ñ –±–µ–∑–ª—ñ—á –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Å—è –Ω–∏–º–∏!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –º—Ä—ñ—è—Ç–∏ ‚Äì –º—Ä—ñ—ó –∑–¥—ñ–π—Å–Ω—é—é—Ç—å—Å—è!",
        "–¢–∏ —Å–∏–ª—å–Ω–∏–π, –Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ –Ω–µ –≤—ñ–¥—á—É–≤–∞—î—à —Ü–µ!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –ø–æ–¥–æ–ª–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ –ø–µ—Ä–µ—à–∫–æ–¥–∏!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ –≤–µ–ª–∏–∫–∏—Ö –≤–∏—Å–æ—Ç!", "–í—ñ—Ä —É —Å–≤–æ—ó —Å–∏–ª–∏, —ñ –≤—Å–µ –±—É–¥–µ –¥–æ–±—Ä–µ!",
        "–ó–∞–≤–∂–¥–∏ –ø–∞–º'—è—Ç–∞–π, —â–æ —Ç–∏ –≤–∞—Ä—Ç–∏–π –±—ñ–ª—å—à–µ!", "–ü—Ä–æ–¥–æ–≤–∂—É–π —Ä–æ–∑–≤–∏–≤–∞—Ç–∏—Å—è ‚Äì –∫–æ–∂–µ–Ω –∫—Ä–æ–∫ –≤–ø–µ—Ä–µ–¥ –≤–∞–∂–ª–∏–≤–∏–π!",
        "–¢–∏ –≤–∂–µ –Ω–∞ —à–ª—è—Ö—É –¥–æ –≤–µ–ª–∏–∫–æ—ó –º–µ—Ç–∏!", "–ù–µ–º–∞—î –Ω—ñ—á–æ–≥–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ–≥–æ –¥–ª—è —Ç–æ–≥–æ, —Ö—Ç–æ –≤—ñ—Ä–∏—Ç—å!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ —à–∞–Ω—Å —Å—Ç–∞—Ç–∏ –∫—Ä–∞—â–∏–º!", "–¢–≤–æ—è —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –∑–∞—Ö–æ–ø–ª—é—î!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—î –∂–∏—Ç—Ç—è –Ω–∞ –∫—Ä–∞—â–µ!", "–°—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π –¥–µ–Ω—å ‚Äì —Ü–µ –Ω–æ–≤–∏–π –ø–æ—á–∞—Ç–æ–∫!",
        "–¢–∏ –Ω–µ –æ–¥–∏–Ω ‚Äì –º–∏ –≤—Å—ñ —Ç—É—Ç, —â–æ–± –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–±–µ!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –±—É—Ç–∏ —ñ–Ω—à–∏–º–∏, –≤–∏ –≤–∂–µ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ!",
        "–í—Å—ñ –≤–µ–ª–∏–∫—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∫—Ä–æ–∫—ñ–≤!", "–¢–∏ ‚Äì –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –Ω–∞—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è!",
        "–í–∞—à–∞ —Ä—ñ—à—É—á—ñ—Å—Ç—å —ñ —Å–∏–ª–∞ –≤–æ–ª—ñ –Ω–µ–π–º–æ–≤—ñ—Ä–Ω—ñ!", "–ü–∞–º‚Äô—è—Ç–∞–π, —â–æ —Ç–∏ ‚Äì –Ω–µ–≤—ñ–¥‚Äô—î–º–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ —Ü—å–æ–≥–æ —Å–≤—ñ—Ç—É!",
        "–¢–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫, —Ç–µ–ø–µ—Ä —ñ–¥–∏ –¥–∞–ª—ñ!", "–ü—ñ–¥–∫–æ—Ä—é–π —Å–≤–æ—ó –º—Ä—ñ—ó —Ç–∞ –∞–º–±—ñ—Ü—ñ—ó!",
        "–°–º—ñ–ª–∏–≤–æ –π–¥–∏ –≤–ø–µ—Ä–µ–¥, —Å–≤—ñ—Ç —á–µ–∫–∞—î –Ω–∞ —Ç–µ–±–µ!", "–¢–∏ –≤—Å–µ –∑–¥–æ–ª–∞—î—à!",
        "–£ —Ç–µ–±–µ —î —Å–∏–ª–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ–π –¥–µ–Ω—å –æ—Å–æ–±–ª–∏–≤–∏–º!", "–©–æ –± –Ω–µ —Å—Ç–∞–ª–æ—Å—è, –ø–∞–º‚Äô—è—Ç–∞–π: —Ç–∏ –∑–∞–≤–∂–¥–∏ –º–∞—î—à –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—é!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è –Ω–µ –º–∞—î –º–µ–∂!", "–ó–∞–≤–∂–¥–∏ –ø–∞–º‚Äô—è—Ç–∞–π –ø—Ä–æ —Å–≤–æ—é —Ü—ñ–Ω–Ω—ñ—Å—Ç—å!",
        "–¢–∏ –º–∞—î—à —Å–∏–ª—É –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Å–≤—ñ—Ç –Ω–∞ –∫—Ä–∞—â–µ!", "–¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –≥–µ—Ä–æ–π —É –≤–ª–∞—Å–Ω—ñ–π —ñ—Å—Ç–æ—Ä—ñ—ó!",
        "–°—å–æ–≥–æ–¥–Ω—ñ –±—É–¥–µ —â–µ –æ–¥–∏–Ω —á—É–¥–æ–≤–∏–π –¥–µ–Ω—å!", "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –ø–æ–¥–æ–ª–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!",
        "–¢–∏ –º–∞—î—à –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Å–∏–ª—É, —è–∫–∞ –¥–æ–ø–æ–º–æ–∂–µ –ø–æ–¥–æ–ª–∞—Ç–∏ –≤—Å–µ!", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ –≤—Å—ñ –Ω–∞–π–∫—Ä–∞—â—ñ —Ä–µ—á—ñ –≤ –∂–∏—Ç—Ç—ñ!",
        "–¢–∏ ‚Äì –Ω–∞—Ç—Ö–Ω–µ–Ω–Ω—è –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –∑–º—ñ–Ω, –≤–æ–Ω–∏ –ø—Ä–∏–≤–æ–¥—è—Ç—å –¥–æ –≤–µ–ª–∏–∫–æ–≥–æ!",
        "–í–∞—à–∞ —Ü—ñ–ª—å –∑–æ–≤—Å—ñ–º –±–ª–∏–∑—å–∫–æ, —Ç—Ä–∏–º–∞–π—Å—è!", "–¢–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π, –Ω—ñ–∂ —Ç–∏ –¥—É–º–∞—î—à!",
        "–ë—É–¥—å –≤–ø–µ–≤–Ω–µ–Ω–∏–π —É —Å–æ–±—ñ ‚Äì —Ç–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ª—ñ–¥–µ—Ä!", "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤–æ—î —â–∞—Å—Ç—è!",
        "–¢–∏ ‚Äì —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π, –Ω–µ –∑–∞–±—É–≤–∞–π –ø—Ä–æ —Ü–µ!", "–ñ–∏—Ç—Ç—è –Ω–µ –º–∞—î –º–µ–∂, —ñ —Ç–≤–æ—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ ‚Äì —Ç–µ–∂!",
        "–°—å–æ–≥–æ–¥–Ω—ñ —Å–∞–º–µ —Ç–æ–π –¥–µ–Ω—å, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏ –Ω–æ–≤–∏–π —à–ª—è—Ö!", "–¢–∏ ‚Äì —á—É–¥–æ–≤–∏–π, –ø—Ä–æ–¥–æ–≤–∂—É–π –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–¥ —Å–æ–±–æ—é!",
        "–í—ñ—Ä —É —Å–µ–±–µ, —ñ —Ç–∏ –ø–æ–±–∞—á–∏—à —á—É–¥–µ—Å–∞!", "–¢–≤–æ—è –ø—Ä–∞—Ü—è –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—Ä–∏–Ω–µ—Å–µ –ø–ª–æ–¥–∏!",
        "–ù–µ –∑–∞–±—É–≤–∞–π, —â–æ —Ç–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π –∑–∞ –±—É–¥—å-—è–∫—ñ –æ–±—Å—Ç–∞–≤–∏–Ω–∏!", "–í–∞—à–∞ –µ–Ω–µ—Ä–≥—ñ—è –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ü–µ–π —Å–≤—ñ—Ç!",
        "–¢–∏ –≤–∂–µ –Ω–∞ –ø—ñ–≤—à–ª—è—Ö—É –¥–æ —Å–≤–æ—î—ó –º–µ—Ç–∏!", "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –±—É—Ç–∏ —â–∞—Å–ª–∏–≤–∏–º!",
        "–¢–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–∏–π –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø—Ä–∞–≤!", "–ö–æ–∂–µ–Ω –∫—Ä–æ–∫ –Ω–∞–±–ª–∏–∂–∞—î —Ç–µ–±–µ –¥–æ –º—Ä—ñ—ó!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å —ñ –≤—ñ—Ä–∞ –≤ —Å–µ–±–µ –±–µ–∑—Ü—ñ–Ω–Ω—ñ!", "–¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –±–æ—î—Ü—å ‚Äì –ø—Ä–æ–¥–æ–≤–∂—É–π –±–æ—Ä–æ—Ç–∏—Å—è!",
        "–í—Å—ñ –≤–µ–ª–∏–∫—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∫—Ä–æ–∫—ñ–≤!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —Ç–∏ –¥—É–º–∞—î—à!",
        "–ù–µ –±—ñ–π—Ç–µ—Å—è —Ç—Ä—É–¥–Ω–æ—â—ñ–≤ ‚Äì –≤–æ–Ω–∏ —Ä–æ–±–ª—è—Ç—å –≤–∞—Å —Å–∏–ª—å–Ω—ñ—à–∏–º–∏!", "–ù–µ –∑–∞–±—É–≤–∞–π, —â–æ —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤—ñ—Ç!",
        "–¢–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –Ω–∞–π–≤–∞–∂—á–∏–π –∫—Ä–æ–∫ ‚Äì –¥—ñ–π!", "–¢–∏ –º–æ–∂–µ—à –∑—Ä–æ–±–∏—Ç–∏ –≤—Å–µ, —â–æ –∑–∞–±–∞–∂–∞—î—à!",
        "–¢–≤–æ—è –≤—ñ—Ä–∞ –≤ —Å–µ–±–µ ‚Äì —Ü–µ —Ç–≤–æ—è —Å–∏–ª–∞!", "–ë—É–¥—å –≤—ñ–¥–≤–∞–∂–Ω–∏–º, –º—Ä—ñ—ó –∑–¥—ñ–π—Å–Ω—é—é—Ç—å—Å—è!",
        "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –¥–æ—Å—è–≥—Ç–∏ –±—É–¥—å-—è–∫–æ—ó –≤–µ—Ä—à–∏–Ω–∏!", "–ù–µ –¥–æ–∑–≤–æ–ª—è–π —Å—É–º–Ω—ñ–≤–∞–º –∑—É–ø–∏–Ω—è—Ç–∏ —Ç–µ–±–µ!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ —à–∞–Ω—Å —Å—Ç–∞—Ç–∏ –∫—Ä–∞—â–∏–º!", "–¢–∏ –≤–æ–ª–æ–¥—ñ—î—à –±–µ–∑–º–µ–∂–Ω–æ—é –µ–Ω–µ—Ä–≥—ñ—î—é!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ —Å–≤–æ—ó –º—Ä—ñ—ó!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –ø—ñ–¥–∫–æ—Ä–∏—Ç–∏ –±—É–¥—å-—è–∫—ñ –≤–µ—Ä—à–∏–Ω–∏!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –ø–æ–¥–æ–ª–∞—Ç–∏ –≤—Å—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!", "–¢–∏ –≥–æ—Ç–æ–≤–∏–π –¥–æ –Ω–æ–≤–∏—Ö –∑–≤–µ—Ä—à–µ–Ω—å!",
        "–¢–∏ —á—É–¥–æ–≤–∏–π, —ñ —Ü–µ –Ω–µ –º–æ–∂–Ω–∞ –∑–∞–ø–µ—Ä–µ—á–∏—Ç–∏!", "–í—ñ—Ä —É —Å–µ–±–µ —ñ –Ω–µ –±—ñ–π—Ç–µ—Å—è –ø–æ–º–∏–ª–æ–∫!",
        "–¢–∏ ‚Äì –¥–∂–µ—Ä–µ–ª–æ –ø–æ–∑–∏—Ç–∏–≤—É –¥–ª—è –Ω–∞–≤–∫–æ–ª–∏—à–Ω—ñ—Ö!", "–°–ø—Ä–∞–≤–∂–Ω—è —Å–∏–ª–∞ –≤ —Ç–≤–æ—ó—Ö —Ä—É–∫–∞—Ö!",
        "–ü–∞–º‚Äô—è—Ç–∞–π, —â–æ –Ω–µ–º–∞—î –Ω—ñ—á–æ–≥–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ–≥–æ!", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ –Ω–∞–π–∫—Ä–∞—â–µ!",
        "–¢–≤—ñ–π —à–ª—è—Ö ‚Äì —Ü–µ —à–ª—è—Ö –ø–µ—Ä–µ–º–æ–≥–∏!", "–ë—É–¥—å —Å–º—ñ–ª–∏–≤–∏–º, —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –≤–µ–ª–∏–∫—ñ —Å–ø—Ä–∞–≤–∏!",
        "–¢–∏ –≤–∂–µ –±–ª–∏–∑—å–∫–æ –¥–æ —Å–≤–æ—î—ó –º–µ—Ç–∏ ‚Äì –ø—Ä–æ–¥–æ–≤–∂—É–π –π—Ç–∏!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –≤–∏–≥–ª—è–¥–∞—Ç–∏ —ñ–Ω—à–∏–º–∏ ‚Äì —Ü–µ –≤–∞—à —Å—Ç–∏–ª—å!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ!", "–¢–∏ ‚Äì –ø–µ—Ä–µ–º–æ–∂–µ—Ü—å —É –±—É–¥—å-—è–∫—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è ‚Äì —Ü–µ —Ç–≤–æ—î –≤–µ–ª–∏—á–µ–∑–Ω–µ –±–∞–≥–∞—Ç—Å—Ç–≤–æ!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—î –∂–∏—Ç—Ç—è!",
        "–í—ñ—Ä —É —Å–µ–±–µ, —ñ –≤–µ—Å—å —Å–≤—ñ—Ç –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –¥–ª—è —Ç–µ–±–µ!", "–¢–∏ ‚Äì —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –º–∞–π—Å—Ç–µ—Ä —Å–≤–æ—î—ó –¥–æ–ª—ñ!",
        "–†—É—Ö–∞–π—Å—è –≤–ø–µ—Ä–µ–¥, —Ç–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫!", "–¢–∏ –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–µ–ª–∏–∫–∏—Ö –¥–æ—Å—è–≥–Ω–µ–Ω—å!",
        "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –±—É—Ç–∏ –∫—Ä–∞—â–∏–º –≤–µ—Ä—Å—ñ—î—é —Å–µ–±–µ!", "–¢–∏ –º–∞—î—à –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –≤—Ä–∞–∂–∞—î!", "–¢–∏ –Ω–∞–¥–∏—Ö–∞—î—à —ñ–Ω—à–∏—Ö —Å–≤–æ—î—é —Å–∏–ª–æ—é –≤–æ–ª—ñ!"
    ]

    for user in get_all_users():
        try:
            message = random.choice(messages)
            image = get_random_image(query="motivation")
            if image:
                await bot.send_photo(
                    user['user_id'],
                    photo=image,
                    caption=message,
                    reply_markup=create_reaction_keyboard()
                )
                logging.info(f"üì® –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –∫–∞—Ä—Ç–∏–Ω–∫–æ—é –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ {user['user_id']}")
            else:
                logging.warning("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ Pixabay.")
        except Exception as e:
            logging.warning(f"‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ {user['user_id']}: {e}")

# –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –¥–ª—è —â–æ–¥–µ–Ω–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
scheduler = AsyncIOScheduler()
scheduler.add_job(send_random_messages, CronTrigger(hour=18, minute=0, timezone=kyiv_tz))

# –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞
async def main():
    scheduler.start()
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
