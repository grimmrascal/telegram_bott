import asyncio
import logging
import random
import os
import sqlite3
import requests
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from apscheduler.schedulers.asyncio import AsyncIOScheduler
from apscheduler.triggers.cron import CronTrigger
from pytz import timezone
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
load_dotenv()
TOKEN = os.getenv("BOT_TOKEN")
PIXABAY_API_KEY = os.getenv("PIXABAY_API_KEY")

if not TOKEN:
    raise ValueError("‚ùå –¢–æ–∫–µ–Ω –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª .env.")
if not PIXABAY_API_KEY:
    raise ValueError("‚ùå API-–∫–ª—é—á Pixabay –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–∞–π–ª .env.")

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s")

# –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –±–æ—Ç–∞ —ñ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token=TOKEN)
dp = Dispatcher()

# –ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å –ö–∏—î–≤–∞
kyiv_tz = timezone("Europe/Kyiv")

# –°–ø–∏—Å–æ–∫ Telegram user_id –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤—ñ–¥ –±–æ—Ç–∞
ADMIN_USER_IDS = [471637263, 5142786008]  # –ó–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Å–ø–∏—Å–æ–∫ —Ä–µ–∞–ª—å–Ω–∏—Ö user_id

# –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
conn = sqlite3.connect('users.db')
cursor = conn.cursor()

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
cursor.execute('''CREATE TABLE IF NOT EXISTS users (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    user_id INTEGER UNIQUE,
                    username TEXT,
                    first_name TEXT
                )''')
conn.commit()

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ –∑ –∫–Ω–æ–ø–∫–∞–º–∏
def create_reaction_keyboard():
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [
            InlineKeyboardButton(text="‚ù§Ô∏è", callback_data="reaction:like"),
            InlineKeyboardButton(text="üîÑ", callback_data="reaction:new_photo"),
        ]
    ])
    return keyboard

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def add_user(user_id, username, first_name):
    cursor.execute('''
        INSERT OR IGNORE INTO users (user_id, username, first_name)
        VALUES (?, ?, ?)
    ''', (user_id, username, first_name))
    conn.commit()
    # –ù–∞–¥—Å–∏–ª–∞—î–º–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    for admin_id in ADMIN_USER_IDS:
        asyncio.create_task(bot.send_message(
            admin_id,
            f"‚úÖ –ù–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–¥–∞–Ω–∏–π:\nID: {user_id}\n–Ü–º'—è: {first_name}\n–ù—ñ–∫–Ω–µ–π–º: @{username if username else '–Ω–µ–º–∞—î'}"
        ))

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def remove_user(user_id):
    cursor.execute('SELECT username, first_name FROM users WHERE user_id = ?', (user_id,))
    user = cursor.fetchone()
    cursor.execute('DELETE FROM users WHERE user_id = ?', (user_id,))
    conn.commit()
    # –ù–∞–¥—Å–∏–ª–∞—î–º–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    if user:
        username, first_name = user
        for admin_id in ADMIN_USER_IDS:
            asyncio.create_task(bot.send_message(
                admin_id,
                f"‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–¥–∞–ª–µ–Ω–∏–π:\nID: {user_id}\n–Ü–º'—è: {first_name}\n–ù—ñ–∫–Ω–µ–π–º: @{username if username else '–Ω–µ–º–∞—î'}"
            ))

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
def get_all_users():
    cursor.execute('SELECT user_id, username, first_name FROM users')
    return cursor.fetchall()

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞ —Ç–µ–º–æ—é
def get_random_image(query="funny, kids, sunset, motivation, mountains, forests, cute"):
    url = f"https://pixabay.com/api/?key={PIXABAY_API_KEY}&q={query}&image_type=photo&per_page=50"
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        if data["hits"]:
            return random.choice(data["hits"])["webformatURL"]
    return None

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /start
@dp.message(Command("start"))
async def start_handler(message: types.Message):
    user_id = message.from_user.id
    username = message.from_user.username
    first_name = message.from_user.first_name

    add_user(user_id, username, first_name)
    await message.answer(f"–ü—Ä–∏–≤—ñ—Ç, {first_name}! –¢–∏ –¥–æ–¥–∞–Ω–∞ —É —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—Å–∏–ª–∫–∏.")
    logging.info(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} ({username}) –¥–æ–¥–∞–Ω–∏–π —É —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—Å–∏–ª–∫–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /sendnow –¥–ª—è –º–∏—Ç—Ç—î–≤–æ—ó —Ä–æ–∑—Å–∏–ª–∫–∏
@dp.message(Command("sendnow"))
async def send_now_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        await send_random_messages()
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /get_users –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É —É—á–∞—Å–Ω–∏–∫—ñ–≤
@dp.message(Command("get_users"))
async def get_users_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        users = get_all_users()
        if users:
            user_list = "\n".join([f"ID: {user[0]}, –Ü–º'—è: {user[2]}, –ù—ñ–∫–Ω–µ–π–º: @{user[1] if user[1] else '–Ω–µ–º–∞—î'}" for user in users])
            await message.answer(f"üìã –°–ø–∏—Å–æ–∫ —É—á–∞—Å–Ω–∏–∫—ñ–≤:\n{user_list}")
        else:
            await message.answer("‚ùå –°–ø–∏—Å–æ–∫ —É—á–∞—Å–Ω–∏–∫—ñ–≤ –ø–æ—Ä–æ–∂–Ω—ñ–π.")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /add_user –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
@dp.message(Command("add_user"))
async def add_user_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        try:
            # –†–æ–∑–¥—ñ–ª—è—î–º–æ —Ç–µ–∫—Å—Ç –∫–æ–º–∞–Ω–¥–∏ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
            command_parts = message.text.split(maxsplit=3)
            if len(command_parts) < 4:
                await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: /add_user <user_id> <username> <first_name>")
                return

            user_id = int(command_parts[1])
            username = command_parts[2]
            first_name = command_parts[3]

            # –î–æ–¥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
            add_user(user_id, username, first_name)
            await message.answer(f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–¥–∞–Ω–∏–π:\nID: {user_id}\n–Ü–º'—è: {first_name}\n–ù—ñ–∫–Ω–µ–π–º: @{username}")
        except ValueError:
            await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. user_id –º–∞—î –±—É—Ç–∏ —á–∏—Å–ª–æ–º.")
        except Exception as e:
            await message.answer(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞: {e}")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –ø—Ä–∏—î–º–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
async def send_random_messages():
    messages = [
        "–¢–∏ —á—É–¥–æ–≤–∏–π!", "–ù–µ –∑–∞–±—É–≤–∞–π –ø–æ—Å–º—ñ—Ö–∞—Ç–∏—Å—è!", "–í —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ!", "–¢–∏ –æ—Å–æ–±–ª–∏–≤–∏–π!", "–¢–∏ —á—É–¥–æ–≤–∏–π!", "–ù–µ –∑–∞–±—É–≤–∞–π –ø–æ—Å–º—ñ—Ö–∞—Ç–∏—Å—è!", "–í —Ç–µ–±–µ –≤—Å–µ –≤–∏–π–¥–µ!", "–¢–∏ –æ—Å–æ–±–ª–∏–≤–∏–π!",
        "–ù–æ–≤–∏–π –¥–µ–Ω—å ‚Äì –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ! –õ–æ–≤–∏ —ó—Ö!", "–¢–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π, –Ω—ñ–∂ –¥—É–º–∞—î—à. –£—Å–µ –≤–∏–π–¥–µ!",
        "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–≤—ñ–π –¥–µ–Ω—å ‚Äì –∑—Ä–æ–±–∏ –π–æ–≥–æ –∫—Ä—É—Ç–∏–º!", "–ü—Ä–æ–∫–∏–¥–∞–π—Å—è! –£ —Å–≤—ñ—Ç—É –¥–ª—è —Ç–µ–±–µ —î —â–æ—Å—å –æ—Å–æ–±–ª–∏–≤–µ!",
        "–°–æ–Ω—Ü–µ –≤–∂–µ —Å–≤—ñ—Ç–∏—Ç—å –¥–ª—è —Ç–µ–±–µ ‚Äì —á–∞—Å –ø—ñ–¥–∫–æ—Ä—é–≤–∞—Ç–∏ —Å–≤—ñ—Ç!", "–ó—Ä–æ–±–∏ —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–µ, –ø—Ä–æ —â–æ –∑–∞–≤—Ç—Ä–∞ –ø–æ–¥—è–∫—É—î—à —Å–æ–±—ñ!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è ‚Äì —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞! –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π —ó—ó!", "–ö–æ–∂–µ–Ω –Ω–æ–≤–∏–π —Ä–∞–Ω–æ–∫ ‚Äì —Ü–µ —à–∞–Ω—Å –ø–æ—á–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É!",
        "–ù–µ –±—ñ–π—Å—è —Ç—Ä—É–¥–Ω–æ—â—ñ–≤ ‚Äì –≤–æ–Ω–∏ —Ä–æ–±–ª—è—Ç—å —Ç–µ–±–µ —Å–∏–ª—å–Ω—ñ—à–∏–º!", "–°—å–æ–≥–æ–¥–Ω—ñ —Ç–∏ –Ω–∞ –∫—Ä–æ–∫ –±–ª–∏–∂—á–µ –¥–æ —Å–≤–æ—î—ó –º—Ä—ñ—ó!",
        "–î–∏—Ö–∞–π –≥–ª–∏–±—à–µ, —É—Å–º—ñ—Ö–∞–π—Å—è —à–∏—Ä—à–µ ‚Äì –≤–ø–µ—Ä–µ–¥ –¥–æ —É—Å–ø—ñ—Ö—É!", "–°–≤—ñ—Ç —á–µ–∫–∞—î –Ω–∞ —Ç–≤–æ—ó –∑–≤–µ—Ä—à–µ–Ω–Ω—è!",
        "–ë—É–¥—å —Å–æ–±–æ—é ‚Äì —Ü–µ –≤–∂–µ —Ç–≤–æ—è —Å—É–ø–µ—Ä—Å–∏–ª–∞!", "–ö–∞–≤–∞, –∑–∞—Ä—è–¥ –ø–æ–∑–∏—Ç–∏–≤—É —ñ –≤–ø–µ—Ä–µ–¥ –¥–æ –ø–µ—Ä–µ–º–æ–≥!",
        "–©–∞—Å–ª–∏–≤–∏–π –¥–µ–Ω—å –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ —É—Å–º—ñ—à–∫–∏!", "–ù–µ –≤—ñ–¥–∫–ª–∞–¥–∞–π —â–∞—Å—Ç—è ‚Äì —Å—Ç–≤–æ—Ä—é–π –π–æ–≥–æ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!",
        "–†–æ–±–∏ —Ç–µ, —â–æ –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Ç–æ–±—ñ —Ä–∞–¥—ñ—Å—Ç—å!", "–¢–≤–æ—ó —Å—Ç–∞—Ä–∞–Ω–Ω—è –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –ø—Ä–∏–Ω–µ—Å—É—Ç—å –ø–ª–æ–¥–∏!",
        "–ú–∞–ª–µ–Ω—å–∫—ñ –∫—Ä–æ–∫–∏ –≤–µ–¥—É—Ç—å –¥–æ –≤–µ–ª–∏–∫–∏—Ö –ø–µ—Ä–µ–º–æ–≥!", "–ó–∞—Ä–∞–∑ ‚Äì –Ω–∞–π–∫—Ä–∞—â–∏–π —á–∞—Å, —â–æ–± –ø–æ—á–∞—Ç–∏ –¥—ñ—è—Ç–∏!",
        "–ù–∞–≤—ñ—Ç—å –Ω–∞–π—Ç–µ–º–Ω—ñ—à–∏–π —Ä–∞–Ω–æ–∫ –º–æ–∂–µ —Å—Ç–∞—Ç–∏ —è—Å–∫—Ä–∞–≤–∏–º!", "–í—ñ–¥–ø—É—Å—Ç–∏ —Å—É–º–Ω—ñ–≤–∏ ‚Äì –≤–ø–µ—Ä–µ–¥ –¥–æ –∑–≤–µ—Ä—à–µ–Ω—å!",
        "–ñ–∏–≤–∏ —Ü–µ–π –¥–µ–Ω—å —Ç–∞–∫, —â–æ–± —É–≤–µ—á–µ—Ä—ñ —Å–∫–∞–∑–∞—Ç–∏: ‚Äú–Ø –º–æ–ª–æ–¥–µ—Ü—å!‚Äù", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ —â–∞—Å–ª–∏–≤–µ —ñ –Ω–∞—Å–∏—á–µ–Ω–µ –∂–∏—Ç—Ç—è!",
        "–î–∏–≤–∏—Å—å –Ω–∞ —Å–≤—ñ—Ç –∑ –æ–ø—Ç–∏–º—ñ–∑–º–æ–º ‚Äì –≤—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å —Ç–æ–±—ñ —Ç–∏–º —Å–∞–º–∏–º!", "–ö–æ–∂–Ω–∞ —Ç–≤–æ—è –¥—ñ—è ‚Äì —Ü–µ –∫—Ä–æ–∫ –¥–æ —É—Å–ø—ñ—Ö—É!",
        "–†–æ–∑–ø—Ä–∞–≤ –∫—Ä–∏–ª–∞ —ñ –ª–µ—Ç–∏ –¥–æ —Å–≤–æ—î—ó –º—Ä—ñ—ó!", "–¢–∏ –º–æ–∂–µ—à –¥–æ—Å—è–≥—Ç–∏ –≤—Å—å–æ–≥–æ, —â–æ –∑–∞–¥—É–º–∞–Ω–æ!", "–ù–æ–≤–∏–π –¥–µ–Ω—å ‚Äì –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ. –í–ø–µ—Ä–µ–¥!",      "–¢–∏ –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–∏–π!", "–í—ñ—Ä —É —Å–µ–±–µ ‚Äì —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –±—ñ–ª—å—à–µ!", "–¢–∏ –∑–¥–æ–ª–∞—î—à –±—É–¥—å-—è–∫—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!",
        "–ù—ñ–∫–æ–ª–∏ –Ω–µ –∑–¥–∞–≤–∞–π—Å—è!", "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ –Ω–æ–≤–∏–π —à–∞–Ω—Å!", "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ –º–µ—Ç–∏!",
        "–ü—Ä–æ–¥–æ–≤–∂—É–π —Ä—É—Ö–∞—Ç–∏—Å—è –≤–ø–µ—Ä–µ–¥, —Ç–∏ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —à–ª—è—Ö—É!", "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å ‚Äì —Ç–≤—ñ–π –∫–ª—é—á –¥–æ —É—Å–ø—ñ—Ö—É!",
        "–ñ–∏—Ç—Ç—è –¥–∞—Ä—É—î —Ç–æ–±—ñ –±–µ–∑–ª—ñ—á –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Å—è –Ω–∏–º–∏!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –º—Ä—ñ—è—Ç–∏ ‚Äì –º—Ä—ñ—ó –∑–¥—ñ–π—Å–Ω—é—é—Ç—å—Å—è!",
        "–¢–∏ —Å–∏–ª—å–Ω–∏–π, –Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ –Ω–µ –≤—ñ–¥—á—É–≤–∞—î—à —Ü–µ!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –ø–æ–¥–æ–ª–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ –ø–µ—Ä–µ—à–∫–æ–¥–∏!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ –≤–µ–ª–∏–∫–∏—Ö –≤–∏—Å–æ—Ç!", "–í—ñ—Ä —É —Å–≤–æ—ó —Å–∏–ª–∏, —ñ –≤—Å–µ –±—É–¥–µ –¥–æ–±—Ä–µ!",
        "–ó–∞–≤–∂–¥–∏ –ø–∞–º'—è—Ç–∞–π, —â–æ —Ç–∏ –≤–∞—Ä—Ç–∏–π –±—ñ–ª—å—à–µ!", "–ü—Ä–æ–¥–æ–≤–∂—É–π —Ä–æ–∑–≤–∏–≤–∞—Ç–∏—Å—è ‚Äì –∫–æ–∂–µ–Ω –∫—Ä–æ–∫ –≤–ø–µ—Ä–µ–¥ –≤–∞–∂–ª–∏–≤–∏–π!",
        "–¢–∏ –≤–∂–µ –Ω–∞ —à–ª—è—Ö—É –¥–æ –≤–µ–ª–∏–∫–æ—ó –º–µ—Ç–∏!", "–ù–µ–º–∞—î –Ω—ñ—á–æ–≥–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ–≥–æ –¥–ª—è —Ç–æ–≥–æ, —Ö—Ç–æ –≤—ñ—Ä–∏—Ç—å!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ —à–∞–Ω—Å —Å—Ç–∞—Ç–∏ –∫—Ä–∞—â–∏–º!", "–¢–≤–æ—è —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –∑–∞—Ö–æ–ø–ª—é—î!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—î –∂–∏—Ç—Ç—è –Ω–∞ –∫—Ä–∞—â–µ!", "–°—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π –¥–µ–Ω—å ‚Äì —Ü–µ –Ω–æ–≤–∏–π –ø–æ—á–∞—Ç–æ–∫!",
        "–¢–∏ –Ω–µ –æ–¥–∏–Ω ‚Äì –º–∏ –≤—Å—ñ —Ç—É—Ç, —â–æ–± –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–±–µ!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –±—É—Ç–∏ —ñ–Ω—à–∏–º–∏, –≤–∏ –≤–∂–µ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ!",
        "–í—Å—ñ –≤–µ–ª–∏–∫—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∫—Ä–æ–∫—ñ–≤!", "–¢–∏ ‚Äì –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –Ω–∞—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è!",
        "–í–∞—à–∞ —Ä—ñ—à—É—á—ñ—Å—Ç—å —ñ —Å–∏–ª–∞ –≤–æ–ª—ñ –Ω–µ–π–º–æ–≤—ñ—Ä–Ω—ñ!", "–ü–∞–º‚Äô—è—Ç–∞–π, —â–æ —Ç–∏ ‚Äì –Ω–µ–≤—ñ–¥‚Äô—î–º–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ —Ü—å–æ–≥–æ —Å–≤—ñ—Ç—É!",
        "–¢–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫, —Ç–µ–ø–µ—Ä —ñ–¥–∏ –¥–∞–ª—ñ!", "–ü—ñ–¥–∫–æ—Ä—é–π —Å–≤–æ—ó –º—Ä—ñ—ó —Ç–∞ –∞–º–±—ñ—Ü—ñ—ó!",
        "–°–º—ñ–ª–∏–≤–æ –π–¥–∏ –≤–ø–µ—Ä–µ–¥, —Å–≤—ñ—Ç —á–µ–∫–∞—î –Ω–∞ —Ç–µ–±–µ!", "–¢–∏ –≤—Å–µ –∑–¥–æ–ª–∞—î—à!",
        "–£ —Ç–µ–±–µ —î —Å–∏–ª–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ–π –¥–µ–Ω—å –æ—Å–æ–±–ª–∏–≤–∏–º!", "–©–æ –± –Ω–µ —Å—Ç–∞–ª–æ—Å—è, –ø–∞–º‚Äô—è—Ç–∞–π: —Ç–∏ –∑–∞–≤–∂–¥–∏ –º–∞—î—à –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—é!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è –Ω–µ –º–∞—î –º–µ–∂!", "–ó–∞–≤–∂–¥–∏ –ø–∞–º‚Äô—è—Ç–∞–π –ø—Ä–æ —Å–≤–æ—é —Ü—ñ–Ω–Ω—ñ—Å—Ç—å!",
        "–¢–∏ –º–∞—î—à —Å–∏–ª—É –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Å–≤—ñ—Ç –Ω–∞ –∫—Ä–∞—â–µ!", "–¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –≥–µ—Ä–æ–π —É –≤–ª–∞—Å–Ω—ñ–π —ñ—Å—Ç–æ—Ä—ñ—ó!",
        "–°—å–æ–≥–æ–¥–Ω—ñ –±—É–¥–µ —â–µ –æ–¥–∏–Ω —á—É–¥–æ–≤–∏–π –¥–µ–Ω—å!", "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –ø–æ–¥–æ–ª–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!",
        "–¢–∏ –º–∞—î—à –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Å–∏–ª—É, —è–∫–∞ –¥–æ–ø–æ–º–æ–∂–µ –ø–æ–¥–æ–ª–∞—Ç–∏ –≤—Å–µ!", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ –≤—Å—ñ –Ω–∞–π–∫—Ä–∞—â—ñ —Ä–µ—á—ñ –≤ –∂–∏—Ç—Ç—ñ!",
        "–¢–∏ ‚Äì –Ω–∞—Ç—Ö–Ω–µ–Ω–Ω—è –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –∑–º—ñ–Ω, –≤–æ–Ω–∏ –ø—Ä–∏–≤–æ–¥—è—Ç—å –¥–æ –≤–µ–ª–∏–∫–æ–≥–æ!",
        "–í–∞—à–∞ —Ü—ñ–ª—å –∑–æ–≤—Å—ñ–º –±–ª–∏–∑—å–∫–æ, —Ç—Ä–∏–º–∞–π—Å—è!", "–¢–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π, –Ω—ñ–∂ —Ç–∏ –¥—É–º–∞—î—à!",
        "–ë—É–¥—å –≤–ø–µ–≤–Ω–µ–Ω–∏–π —É —Å–æ–±—ñ ‚Äì —Ç–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –ª—ñ–¥–µ—Ä!", "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤–æ—î —â–∞—Å—Ç—è!",
        "–¢–∏ ‚Äì —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π, –Ω–µ –∑–∞–±—É–≤–∞–π –ø—Ä–æ —Ü–µ!", "–ñ–∏—Ç—Ç—è –Ω–µ –º–∞—î –º–µ–∂, —ñ —Ç–≤–æ—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ ‚Äì —Ç–µ–∂!",
        "–°—å–æ–≥–æ–¥–Ω—ñ —Å–∞–º–µ —Ç–æ–π –¥–µ–Ω—å, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏ –Ω–æ–≤–∏–π —à–ª—è—Ö!", "–¢–∏ ‚Äì —á—É–¥–æ–≤–∏–π, –ø—Ä–æ–¥–æ–≤–∂—É–π –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–¥ —Å–æ–±–æ—é!",
        "–í—ñ—Ä —É —Å–µ–±–µ, —ñ —Ç–∏ –ø–æ–±–∞—á–∏—à —á—É–¥–µ—Å–∞!", "–¢–≤–æ—è –ø—Ä–∞—Ü—è –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—Ä–∏–Ω–µ—Å–µ –ø–ª–æ–¥–∏!",
        "–ù–µ –∑–∞–±—É–≤–∞–π, —â–æ —Ç–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π –∑–∞ –±—É–¥—å-—è–∫—ñ –æ–±—Å—Ç–∞–≤–∏–Ω–∏!", "–í–∞—à–∞ –µ–Ω–µ—Ä–≥—ñ—è –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ü–µ–π —Å–≤—ñ—Ç!",
        "–¢–∏ –≤–∂–µ –Ω–∞ –ø—ñ–≤—à–ª—è—Ö—É –¥–æ —Å–≤–æ—î—ó –º–µ—Ç–∏!", "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –±—É—Ç–∏ —â–∞—Å–ª–∏–≤–∏–º!",
        "–¢–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–∏–π –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø—Ä–∞–≤!", "–ö–æ–∂–µ–Ω –∫—Ä–æ–∫ –Ω–∞–±–ª–∏–∂–∞—î —Ç–µ–±–µ –¥–æ –º—Ä—ñ—ó!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å —ñ –≤—ñ—Ä–∞ –≤ —Å–µ–±–µ –±–µ–∑—Ü—ñ–Ω–Ω—ñ!", "–¢–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –±–æ—î—Ü—å ‚Äì –ø—Ä–æ–¥–æ–≤–∂—É–π –±–æ—Ä–æ—Ç–∏—Å—è!",
        "–í—Å—ñ –≤–µ–ª–∏–∫—ñ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –º–∞–ª–µ–Ω—å–∫–∏—Ö –∫—Ä–æ–∫—ñ–≤!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —Ç–∏ –¥—É–º–∞—î—à!",
        "–ù–µ –±—ñ–π—Ç–µ—Å—è —Ç—Ä—É–¥–Ω–æ—â—ñ–≤ ‚Äì –≤–æ–Ω–∏ —Ä–æ–±–ª—è—Ç—å –≤–∞—Å —Å–∏–ª—å–Ω—ñ—à–∏–º–∏!", "–ù–µ –∑–∞–±—É–≤–∞–π, —â–æ —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤—ñ—Ç!",
        "–¢–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –Ω–∞–π–≤–∞–∂—á–∏–π –∫—Ä–æ–∫ ‚Äì –¥—ñ–π!", "–¢–∏ –º–æ–∂–µ—à –∑—Ä–æ–±–∏—Ç–∏ –≤—Å–µ, —â–æ –∑–∞–±–∞–∂–∞—î—à!",
        "–¢–≤–æ—è –≤—ñ—Ä–∞ –≤ —Å–µ–±–µ ‚Äì —Ü–µ —Ç–≤–æ—è —Å–∏–ª–∞!", "–ë—É–¥—å –≤—ñ–¥–≤–∞–∂–Ω–∏–º, –º—Ä—ñ—ó –∑–¥—ñ–π—Å–Ω—é—é—Ç—å—Å—è!",
        "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –¥–æ—Å—è–≥—Ç–∏ –±—É–¥—å-—è–∫–æ—ó –≤–µ—Ä—à–∏–Ω–∏!", "–ù–µ –¥–æ–∑–≤–æ–ª—è–π —Å—É–º–Ω—ñ–≤–∞–º –∑—É–ø–∏–Ω—è—Ç–∏ —Ç–µ–±–µ!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å ‚Äì —Ü–µ —à–∞–Ω—Å —Å—Ç–∞—Ç–∏ –∫—Ä–∞—â–∏–º!", "–¢–∏ –≤–æ–ª–æ–¥—ñ—î—à –±–µ–∑–º–µ–∂–Ω–æ—é –µ–Ω–µ—Ä–≥—ñ—î—é!",
        "–£ —Ç–µ–±–µ —î –≤—Å–µ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ —Å–≤–æ—ó –º—Ä—ñ—ó!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –ø—ñ–¥–∫–æ—Ä–∏—Ç–∏ –±—É–¥—å-—è–∫—ñ –≤–µ—Ä—à–∏–Ω–∏!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –ø–æ–¥–æ–ª–∞—Ç–∏ –≤—Å—ñ —Ç—Ä—É–¥–Ω–æ—â—ñ!", "–¢–∏ –≥–æ—Ç–æ–≤–∏–π –¥–æ –Ω–æ–≤–∏—Ö –∑–≤–µ—Ä—à–µ–Ω—å!",
        "–¢–∏ —á—É–¥–æ–≤–∏–π, —ñ —Ü–µ –Ω–µ –º–æ–∂–Ω–∞ –∑–∞–ø–µ—Ä–µ—á–∏—Ç–∏!", "–í—ñ—Ä —É —Å–µ–±–µ —ñ –Ω–µ –±—ñ–π—Ç–µ—Å—è –ø–æ–º–∏–ª–æ–∫!",
        "–¢–∏ ‚Äì –¥–∂–µ—Ä–µ–ª–æ –ø–æ–∑–∏—Ç–∏–≤—É –¥–ª—è –Ω–∞–≤–∫–æ–ª–∏—à–Ω—ñ—Ö!", "–°–ø—Ä–∞–≤–∂–Ω—è —Å–∏–ª–∞ –≤ —Ç–≤–æ—ó—Ö —Ä—É–∫–∞—Ö!",
        "–ü–∞–º‚Äô—è—Ç–∞–π, —â–æ –Ω–µ–º–∞—î –Ω—ñ—á–æ–≥–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ–≥–æ!", "–¢–∏ –∑–∞—Å–ª—É–≥–æ–≤—É—î—à –Ω–∞ –Ω–∞–π–∫—Ä–∞—â–µ!",
        "–¢–≤—ñ–π —à–ª—è—Ö ‚Äì —Ü–µ —à–ª—è—Ö –ø–µ—Ä–µ–º–æ–≥–∏!", "–ë—É–¥—å —Å–º—ñ–ª–∏–≤–∏–º, —Ç–∏ –∑–¥–∞—Ç–Ω–∏–π –Ω–∞ –≤–µ–ª–∏–∫—ñ —Å–ø—Ä–∞–≤–∏!",
        "–¢–∏ –≤–∂–µ –±–ª–∏–∑—å–∫–æ –¥–æ —Å–≤–æ—î—ó –º–µ—Ç–∏ ‚Äì –ø—Ä–æ–¥–æ–≤–∂—É–π –π—Ç–∏!", "–ù–µ –±—ñ–π—Ç–µ—Å—è –≤–∏–≥–ª—è–¥–∞—Ç–∏ —ñ–Ω—à–∏–º–∏ ‚Äì —Ü–µ –≤–∞—à —Å—Ç–∏–ª—å!",
        "–ö–æ–∂–µ–Ω –¥–µ–Ω—å –ø—Ä–∏–Ω–æ—Å–∏—Ç—å –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ!", "–¢–∏ ‚Äì –ø–µ—Ä–µ–º–æ–∂–µ—Ü—å —É –±—É–¥—å-—è–∫—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó!",
        "–¢–≤–æ—è –µ–Ω–µ—Ä–≥—ñ—è ‚Äì —Ü–µ —Ç–≤–æ—î –≤–µ–ª–∏—á–µ–∑–Ω–µ –±–∞–≥–∞—Ç—Å—Ç–≤–æ!", "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –∑–º—ñ–Ω–∏—Ç–∏ —Å–≤–æ—î –∂–∏—Ç—Ç—è!",
        "–í—ñ—Ä —É —Å–µ–±–µ, —ñ –≤–µ—Å—å —Å–≤—ñ—Ç –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –¥–ª—è —Ç–µ–±–µ!", "–¢–∏ ‚Äì —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –º–∞–π—Å—Ç–µ—Ä —Å–≤–æ—î—ó –¥–æ–ª—ñ!",
        "–†—É—Ö–∞–π—Å—è –≤–ø–µ—Ä–µ–¥, —Ç–∏ –≤–∂–µ –∑—Ä–æ–±–∏–≤ –ø–µ—Ä—à–∏–π –∫—Ä–æ–∫!", "–¢–∏ –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–µ–ª–∏–∫–∏—Ö –¥–æ—Å—è–≥–Ω–µ–Ω—å!",
        "–¢–∏ –∑–¥–∞—Ç–Ω–∏–π –±—É—Ç–∏ –∫—Ä–∞—â–∏–º –≤–µ—Ä—Å—ñ—î—é —Å–µ–±–µ!", "–¢–∏ –º–∞—î—à –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª!",
        "–¢–≤–æ—è —Ä—ñ—à—É—á—ñ—Å—Ç—å –≤—Ä–∞–∂–∞—î!", "–¢–∏ –Ω–∞–¥–∏—Ö–∞—î—à —ñ–Ω—à–∏—Ö —Å–≤–æ—î—é —Å–∏–ª–æ—é –≤–æ–ª—ñ!"
    ]

    for user_id, username, first_name in get_all_users():
        try:
            message = random.choice(messages)
            image = get_random_image(query="motivation")  # –ó–∞–¥–∞–π—Ç–µ —Ç–µ–º—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "motivation"
            if image:
                await bot.send_photo(
                    user_id,
                    photo=image,
                    caption=message,
                    reply_markup=create_reaction_keyboard()  # –î–æ–¥–∞—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É
                )
                logging.info(f"üì® –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –∫–∞—Ä—Ç–∏–Ω–∫–æ—é –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ {user_id}")
            else:
                logging.warning("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ Pixabay.")
        except Exception as e:
            logging.warning(f"‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ {user_id}: {e}")

# –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /t –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—Å—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
@dp.message(Command("t"))
async def broadcast_handler(message: types.Message):
    if message.from_user.id in ADMIN_USER_IDS:  # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ —Ü–µ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä
        try:
            # –û—Ç—Ä–∏–º—É—î–º–æ —Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–±–æ –ø—ñ–¥–ø–∏—Å –¥–æ —Ñ–æ—Ç–æ
            if message.caption:  # –Ø–∫—â–æ —î –ø—ñ–¥–ø–∏—Å –¥–æ —Ñ–æ—Ç–æ
                broadcast_message = " ".join(message.caption.split()[1:])
            elif message.text:  # –Ø–∫—â–æ —î —Ç–µ–∫—Å—Ç –ø—ñ—Å–ª—è –∫–æ–º–∞–Ω–¥–∏
                broadcast_message = " ".join(message.text.split()[1:])
            else:  # –Ø–∫—â–æ –Ω–µ–º–∞—î —Ç–µ–∫—Å—Ç—É –∞–±–æ –ø—ñ–¥–ø–∏—Å—É
                broadcast_message = None

            users = get_all_users()  # –û—Ç—Ä–∏–º—É—î–º–æ —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

            if not users:
                await message.answer("‚ùå –ù–µ–º–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–ª—è —Ä–æ–∑—Å–∏–ª–∫–∏.")
                return

            # –†–æ–∑—Å–∏–ª–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ–∂–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É, –∫—Ä—ñ–º –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —è–∫–∏–π –π–æ–≥–æ –≤—ñ–¥–ø—Ä–∞–≤–∏–≤
            for user_id, username, first_name in users:
                if user_id == message.from_user.id:  # –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —è–∫–∏–π –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
                    continue
                try:
                    if message.photo:  # –Ø–∫—â–æ —î —Ñ–æ—Ç–æ
                        await bot.send_photo(user_id, photo=message.photo[-1].file_id, caption=broadcast_message)
                    elif broadcast_message:  # –Ø–∫—â–æ —Ç—ñ–ª—å–∫–∏ —Ç–µ–∫—Å—Ç
                        await bot.send_message(user_id, broadcast_message)
                    logging.info(f"üì® –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user_id}")
                except Exception as e:
                    logging.warning(f"‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É {user_id}: {e}")

            await message.answer("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑—ñ—Å–ª–∞–Ω–æ –≤—Å—ñ–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, –∫—Ä—ñ–º –≤–∞—Å!")
        except IndexError:
            await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ: /t <—Ç–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è> –∞–±–æ –ø—Ä–∏–∫—Ä—ñ–ø—ñ—Ç—å —Ñ–æ—Ç–æ –∑ –ø—ñ–¥–ø–∏—Å–æ–º.")
        except Exception as e:
            await message.answer(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ä–æ–∑—Å–∏–ª—Ü—ñ: {e}")
    else:
        await message.answer("‚ùå –£ –≤–∞—Å –Ω–µ–º–∞—î –ø—Ä–∞–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∫–æ–º–∞–Ω–¥–∏.")

# –û–±—Ä–æ–±–Ω–∏–∫ –Ω–∞—Ç–∏—Å–∫–∞–Ω—å –Ω–∞ –∫–Ω–æ–ø–∫–∏
@dp.callback_query()
async def handle_reaction(callback_query: types.CallbackQuery):
    data = callback_query.data  # –û—Ç—Ä–∏–º—É—î–º–æ callback_data
    user_id = callback_query.from_user.id

    if data == "reaction:like":
        await callback_query.answer("‚ù§Ô∏è –î—è–∫—É—é –∑–∞ —Å–µ—Ä–¥–µ—á–∫–æ!")
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} –Ω–∞—Ç–∏—Å–Ω—É–≤ '–°–µ—Ä–¥–µ—á–∫–æ'.")
    elif data == "reaction:new_photo":
        # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–æ–≤–µ —Ñ–æ—Ç–æ
        new_image = get_random_image(query="motivation")
        if new_image:
            await bot.send_photo(
                user_id,
                photo=new_image,
                caption="–û—Å—å –Ω–æ–≤–µ —Ñ–æ—Ç–æ –¥–ª—è —Ç–µ–±–µ!",
                reply_markup=create_reaction_keyboard()
            )
        await callback_query.answer("üîÑ –û—Å—å –Ω–æ–≤–µ —Ñ–æ—Ç–æ!")
        logging.info(f"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á {user_id} –∑–∞–ø—Ä–æ—Å–∏–≤ –Ω–æ–≤–µ —Ñ–æ—Ç–æ.")

# –ü–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ –¥–ª—è —â–æ–¥–µ–Ω–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (2 —Ä–∞–∑–∏ –Ω–∞ –¥–µ–Ω—å)
scheduler = AsyncIOScheduler()
scheduler.add_job(send_random_messages, CronTrigger(hour=18, minute=0, timezone=kyiv_tz))  # 18:00

# –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞
async def main():
    scheduler.start()  # –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
